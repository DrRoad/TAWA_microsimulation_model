
CalculateJobIncome <- function(Data, UseWageRate, Periods = 1){
  AllJobs = seq(1,9)
  JobVariableNames = c("_ACCWeeks", "_EndPeriod", "_FullTime", "_FullTimeEquivWeeks", "_HoursPerWeek", "_NumPeriodsWorked", 
            "_PPLWeeks", "_StartPeriod", "_WageOrSelfEmployed", "_WeeksOnLeaveWithoutPay")

    Data[,
       paste0("P_Income_Calculated_Jobs_", AllJobs, "_GrossAmountInflated") := .SD,
       .SDcols = paste0("P_Income_Processed_Jobs_", AllJobs, "_GrossAmountInflated")]
    for (name in JobVariableNames){
      Data[,
           paste0("P_Jobs_Calculated_", AllJobs, name) := .SD, 
             .SDcols = paste0("P_Jobs_Processed_",AllJobs, name)]
    }
    Data[,
         ':=' (P_Income_Calculated_ACCReceived = P_Income_Processed_ACCReceived, 
               P_FamilyAssistance_ParentalLeave_Amount_Calculated = P_FamilyAssistance_ParentalLeave_Amount_Processed, 
               P_ImputedWage_UsedImputedWage = 0) ]  
}
attr(CalculateJobIncome, "output") <- c("P_Income_Calculated_Jobs_1_GrossAmountInflated",
                                        "P_Jobs_Calculated_1_ACCWeeks",
                                        "P_Jobs_Calculated_1_EndPeriod",
                                        "P_Jobs_Calculated_1_FullTime",
                                        "P_Jobs_Calculated_1_FullTimeEquivWeeks",
                                        "P_Jobs_Calculated_1_HoursPerWeek",
                                        "P_Jobs_Calculated_1_NumPeriodsWorked",
                                        "P_Jobs_Calculated_1_PPLWeeks",
                                        "P_Jobs_Calculated_1_StartPeriod",
                                        "P_Jobs_Calculated_1_WageOrSelfEmployed",
                                        "P_Jobs_Calculated_1_WeeksOnLeaveWithoutPay","P_Income_Calculated_Jobs_2_GrossAmountInflated","P_Jobs_Calculated_2_ACCWeeks","P_Jobs_Calculated_2_EndPeriod","P_Jobs_Calculated_2_FullTime","P_Jobs_Calculated_2_FullTimeEquivWeeks","P_Jobs_Calculated_2_HoursPerWeek","P_Jobs_Calculated_2_NumPeriodsWorked","P_Jobs_Calculated_2_PPLWeeks","P_Jobs_Calculated_2_StartPeriod","P_Jobs_Calculated_2_WageOrSelfEmployed","P_Jobs_Calculated_2_WeeksOnLeaveWithoutPay","P_Income_Calculated_Jobs_3_GrossAmountInflated","P_Jobs_Calculated_3_ACCWeeks","P_Jobs_Calculated_3_EndPeriod","P_Jobs_Calculated_3_FullTime","P_Jobs_Calculated_3_FullTimeEquivWeeks","P_Jobs_Calculated_3_HoursPerWeek","P_Jobs_Calculated_3_NumPeriodsWorked","P_Jobs_Calculated_3_PPLWeeks","P_Jobs_Calculated_3_StartPeriod","P_Jobs_Calculated_3_WageOrSelfEmployed","P_Jobs_Calculated_3_WeeksOnLeaveWithoutPay","P_Income_Calculated_Jobs_4_GrossAmountInflated","P_Jobs_Calculated_4_ACCWeeks","P_Jobs_Calculated_4_EndPeriod","P_Jobs_Calculated_4_FullTime","P_Jobs_Calculated_4_FullTimeEquivWeeks","P_Jobs_Calculated_4_HoursPerWeek","P_Jobs_Calculated_4_NumPeriodsWorked","P_Jobs_Calculated_4_PPLWeeks","P_Jobs_Calculated_4_StartPeriod","P_Jobs_Calculated_4_WageOrSelfEmployed","P_Jobs_Calculated_4_WeeksOnLeaveWithoutPay","P_Income_Calculated_Jobs_5_GrossAmountInflated","P_Jobs_Calculated_5_ACCWeeks","P_Jobs_Calculated_5_EndPeriod","P_Jobs_Calculated_5_FullTime","P_Jobs_Calculated_5_FullTimeEquivWeeks","P_Jobs_Calculated_5_HoursPerWeek","P_Jobs_Calculated_5_NumPeriodsWorked","P_Jobs_Calculated_5_PPLWeeks","P_Jobs_Calculated_5_StartPeriod","P_Jobs_Calculated_5_WageOrSelfEmployed","P_Jobs_Calculated_5_WeeksOnLeaveWithoutPay","P_Income_Calculated_Jobs_6_GrossAmountInflated","P_Jobs_Calculated_6_ACCWeeks","P_Jobs_Calculated_6_EndPeriod","P_Jobs_Calculated_6_FullTime","P_Jobs_Calculated_6_FullTimeEquivWeeks","P_Jobs_Calculated_6_HoursPerWeek","P_Jobs_Calculated_6_NumPeriodsWorked","P_Jobs_Calculated_6_PPLWeeks","P_Jobs_Calculated_6_StartPeriod","P_Jobs_Calculated_6_WageOrSelfEmployed","P_Jobs_Calculated_6_WeeksOnLeaveWithoutPay","P_Income_Calculated_Jobs_7_GrossAmountInflated","P_Jobs_Calculated_7_ACCWeeks","P_Jobs_Calculated_7_EndPeriod","P_Jobs_Calculated_7_FullTime","P_Jobs_Calculated_7_FullTimeEquivWeeks","P_Jobs_Calculated_7_HoursPerWeek","P_Jobs_Calculated_7_NumPeriodsWorked","P_Jobs_Calculated_7_PPLWeeks","P_Jobs_Calculated_7_StartPeriod","P_Jobs_Calculated_7_WageOrSelfEmployed","P_Jobs_Calculated_7_WeeksOnLeaveWithoutPay","P_Income_Calculated_Jobs_8_GrossAmountInflated","P_Jobs_Calculated_8_ACCWeeks","P_Jobs_Calculated_8_EndPeriod","P_Jobs_Calculated_8_FullTime","P_Jobs_Calculated_8_FullTimeEquivWeeks","P_Jobs_Calculated_8_HoursPerWeek","P_Jobs_Calculated_8_NumPeriodsWorked","P_Jobs_Calculated_8_PPLWeeks","P_Jobs_Calculated_8_StartPeriod","P_Jobs_Calculated_8_WageOrSelfEmployed","P_Jobs_Calculated_8_WeeksOnLeaveWithoutPay","P_Income_Calculated_Jobs_9_GrossAmountInflated","P_Jobs_Calculated_9_ACCWeeks","P_Jobs_Calculated_9_EndPeriod","P_Jobs_Calculated_9_FullTime","P_Jobs_Calculated_9_FullTimeEquivWeeks","P_Jobs_Calculated_9_HoursPerWeek","P_Jobs_Calculated_9_NumPeriodsWorked","P_Jobs_Calculated_9_PPLWeeks","P_Jobs_Calculated_9_StartPeriod","P_Jobs_Calculated_9_WageOrSelfEmployed","P_Jobs_Calculated_9_WeeksOnLeaveWithoutPay",
                                        "P_Income_Calculated_ACCReceived",
                                        "P_FamilyAssistance_ParentalLeave_Amount_Calculated",
                                        "P_ImputedWage_UsedImputedWage")
attr(CalculateJobIncome, "input")  <- c("P_Income_Processed_Jobs_1_GrossAmountInflated",
                                        "P_Jobs_Processed_1_ACCWeeks",
                                        "P_Jobs_Processed_1_EndPeriod",
                                        "P_Jobs_Processed_1_FullTime",
                                        "P_Jobs_Processed_1_FullTimeEquivWeeks",
                                        "P_Jobs_Processed_1_HoursPerWeek",
                                        "P_Jobs_Processed_1_NumPeriodsWorked",
                                        "P_Jobs_Processed_1_PPLWeeks",
                                        "P_Jobs_Processed_1_StartPeriod",
                                        "P_Jobs_Processed_1_WageOrSelfEmployed",
                                        "P_Jobs_Processed_1_WeeksOnLeaveWithoutPay","P_Income_Processed_Jobs_2_GrossAmountInflated","P_Jobs_Processed_2_ACCWeeks","P_Jobs_Processed_2_EndPeriod","P_Jobs_Processed_2_FullTime","P_Jobs_Processed_2_FullTimeEquivWeeks","P_Jobs_Processed_2_HoursPerWeek","P_Jobs_Processed_2_NumPeriodsWorked","P_Jobs_Processed_2_PPLWeeks","P_Jobs_Processed_2_StartPeriod","P_Jobs_Processed_2_WageOrSelfEmployed","P_Jobs_Processed_2_WeeksOnLeaveWithoutPay","P_Income_Processed_Jobs_3_GrossAmountInflated","P_Jobs_Processed_3_ACCWeeks","P_Jobs_Processed_3_EndPeriod","P_Jobs_Processed_3_FullTime","P_Jobs_Processed_3_FullTimeEquivWeeks","P_Jobs_Processed_3_HoursPerWeek","P_Jobs_Processed_3_NumPeriodsWorked","P_Jobs_Processed_3_PPLWeeks","P_Jobs_Processed_3_StartPeriod","P_Jobs_Processed_3_WageOrSelfEmployed","P_Jobs_Processed_3_WeeksOnLeaveWithoutPay","P_Income_Processed_Jobs_4_GrossAmountInflated","P_Jobs_Processed_4_ACCWeeks","P_Jobs_Processed_4_EndPeriod","P_Jobs_Processed_4_FullTime","P_Jobs_Processed_4_FullTimeEquivWeeks","P_Jobs_Processed_4_HoursPerWeek","P_Jobs_Processed_4_NumPeriodsWorked","P_Jobs_Processed_4_PPLWeeks","P_Jobs_Processed_4_StartPeriod","P_Jobs_Processed_4_WageOrSelfEmployed","P_Jobs_Processed_4_WeeksOnLeaveWithoutPay","P_Income_Processed_Jobs_5_GrossAmountInflated","P_Jobs_Processed_5_ACCWeeks","P_Jobs_Processed_5_EndPeriod","P_Jobs_Processed_5_FullTime","P_Jobs_Processed_5_FullTimeEquivWeeks","P_Jobs_Processed_5_HoursPerWeek","P_Jobs_Processed_5_NumPeriodsWorked","P_Jobs_Processed_5_PPLWeeks","P_Jobs_Processed_5_StartPeriod","P_Jobs_Processed_5_WageOrSelfEmployed","P_Jobs_Processed_5_WeeksOnLeaveWithoutPay","P_Income_Processed_Jobs_6_GrossAmountInflated","P_Jobs_Processed_6_ACCWeeks","P_Jobs_Processed_6_EndPeriod","P_Jobs_Processed_6_FullTime","P_Jobs_Processed_6_FullTimeEquivWeeks","P_Jobs_Processed_6_HoursPerWeek","P_Jobs_Processed_6_NumPeriodsWorked","P_Jobs_Processed_6_PPLWeeks","P_Jobs_Processed_6_StartPeriod","P_Jobs_Processed_6_WageOrSelfEmployed","P_Jobs_Processed_6_WeeksOnLeaveWithoutPay","P_Income_Processed_Jobs_7_GrossAmountInflated","P_Jobs_Processed_7_ACCWeeks","P_Jobs_Processed_7_EndPeriod","P_Jobs_Processed_7_FullTime","P_Jobs_Processed_7_FullTimeEquivWeeks","P_Jobs_Processed_7_HoursPerWeek","P_Jobs_Processed_7_NumPeriodsWorked","P_Jobs_Processed_7_PPLWeeks","P_Jobs_Processed_7_StartPeriod","P_Jobs_Processed_7_WageOrSelfEmployed","P_Jobs_Processed_7_WeeksOnLeaveWithoutPay","P_Income_Processed_Jobs_8_GrossAmountInflated","P_Jobs_Processed_8_ACCWeeks","P_Jobs_Processed_8_EndPeriod","P_Jobs_Processed_8_FullTime","P_Jobs_Processed_8_FullTimeEquivWeeks","P_Jobs_Processed_8_HoursPerWeek","P_Jobs_Processed_8_NumPeriodsWorked","P_Jobs_Processed_8_PPLWeeks","P_Jobs_Processed_8_StartPeriod","P_Jobs_Processed_8_WageOrSelfEmployed","P_Jobs_Processed_8_WeeksOnLeaveWithoutPay","P_Income_Processed_Jobs_9_GrossAmountInflated","P_Jobs_Processed_9_ACCWeeks","P_Jobs_Processed_9_EndPeriod","P_Jobs_Processed_9_FullTime","P_Jobs_Processed_9_FullTimeEquivWeeks","P_Jobs_Processed_9_HoursPerWeek","P_Jobs_Processed_9_NumPeriodsWorked","P_Jobs_Processed_9_PPLWeeks","P_Jobs_Processed_9_StartPeriod","P_Jobs_Processed_9_WageOrSelfEmployed","P_Jobs_Processed_9_WeeksOnLeaveWithoutPay",
                                        "P_Income_Processed_ACCReceived",
                                        "P_FamilyAssistance_ParentalLeave_Amount_Processed",
                                        "P_Increment_TaxModB_HoursWorked")
